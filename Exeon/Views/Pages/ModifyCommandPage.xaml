<?xml version="1.0" encoding="utf-8"?>
<Page
    x:Class="Exeon.Views.Pages.ModifyCommandPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:Exeon.Views.Pages"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:tools="using:Exeon.ViewModels.Tools"
    xmlns:models_actions="using:Exeon.Models.Actions"
    xmlns:animatedVisuals="using:Microsoft.UI.Xaml.Controls.AnimatedVisuals"
    mc:Ignorable="d"
    Background="{ThemeResource ApplicationPageBackgroundThemeBrush}"
    x:Name="modifyCommandPage">

    <Page.Resources>
        <DataTemplate x:Key="FileActionTemplate">
            <Grid Margin="0,10,0,10">

                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <ImageIcon
                    Height="30"
                    Source="../../Assets/folder.png"
                    Grid.Column="0"/>

                <TextBlock
                    Grid.Column="1"
                    VerticalAlignment="Center"
                    FontSize="13"
                    Margin="10,0,5,0"
                    TextTrimming="CharacterEllipsis"
                    Text="{Binding PathToFile}"/>

                <!--Copy, Delete buttons-->
                <StackPanel
                    Margin="5,0,0,0"
                    Grid.Column="2"
                    Orientation="Horizontal"
                    Spacing="5">

                    <Button
                        x:Name="CopyFileActionPath"
                        Height="30"
                        Width="30"
                        ToolTipService.ToolTip="Скопіювати шлях"
                        Click="CopyFileActionPath_Click">

                        <Viewbox
                            Margin="-4">
                            <SymbolIcon Symbol="Copy"/>
                        </Viewbox>
                    </Button>

                    <Button
                        x:Name="DeleteFileAction"
                        Style="{ThemeResource AccentButtonStyle}"
                        Height="30"
                        Width="30"
                        ToolTipService.ToolTip="{StaticResource DeleteActionTitle}"
                        Click="DeleteFileAction_Click">

                        <Viewbox
                            Margin="-4">
                            <SymbolIcon Symbol="Delete"/>
                        </Viewbox>
                    </Button>
                </StackPanel>
            </Grid>
        </DataTemplate>

        <DataTemplate x:Key="WebActionTemplate">
            <Grid Margin="0,10,0,10">

                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <ImageIcon
                    Height="30"
                    Source="../../Assets/web.png"
                    Grid.Column="0"/>

                <TextBlock
                    Grid.Column="1"
                    VerticalAlignment="Center"
                    FontSize="13"
                    Margin="10,0,5,0"
                    TextTrimming="CharacterEllipsis"
                    Text="{Binding Uri}"/>

                <!--Copy, Delete buttons-->
                <StackPanel
                    Margin="5,0,0,0"
                    Grid.Column="2"
                    Orientation="Horizontal"
                    Spacing="5">

                    <Button
                        x:Name="CopyWebActionUrl"
                        Height="30"
                        Width="30"
                        ToolTipService.ToolTip="Скопіювати URL"
                        Click="CopyWebActionUrl_Click">

                        <Viewbox
                            Margin="-4">
                            <SymbolIcon Symbol="Copy"/>
                        </Viewbox>
                    </Button>

                    <Button
                        x:Name="DeleteWebAction"
                        Style="{ThemeResource AccentButtonStyle}"
                        Height="30"
                        Width="30"
                        ToolTipService.ToolTip="{StaticResource DeleteActionTitle}"
                        Click="DeleteWebAction_Click">

                        <Viewbox
                            Margin="-4">
                            <SymbolIcon Symbol="Delete"/>
                        </Viewbox>
                    </Button>
                </StackPanel>
            </Grid>
        </DataTemplate>

        <DataTemplate x:Key="PauseActionTemplate">
            <Grid Margin="0,10,0,10">

                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <ImageIcon
                    Height="30"
                    Source="../../Assets/clock.png"
                    Grid.Column="0"/>

                <TextBlock
                    Grid.Column="1"
                    VerticalAlignment="Center"
                    FontSize="13"
                    Margin="10,0,5,0"
                    TextTrimming="CharacterEllipsis">
                    
                    <Run Text="Зробити паузу на:"/>
                    <Run Text="{Binding DelayInSeconds}"/>
                </TextBlock>

                <Button
                    x:Name="DeletePauseAction"
                    Grid.Column="2"
                    Style="{ThemeResource AccentButtonStyle}"
                    Height="30"
                    Width="50"
                    Margin="0,0,5,0"
                    ToolTipService.ToolTip="{StaticResource DeleteActionTitle}"
                    Click="DeletePauseAction_Click">

                    <Viewbox
                        Margin="1">
                        <SymbolIcon Symbol="Delete"/>
                    </Viewbox>
                </Button>
            </Grid>
        </DataTemplate>

        <DataTemplate x:Key="BrightnessActionTemplate">
            <Grid Margin="0,10,0,10">

                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <ImageIcon
                    Height="30"
                    Source="../../Assets/brightness.png"
                    Grid.Column="0"/>

                <TextBlock
                    Grid.Column="1"
                    VerticalAlignment="Center"
                    FontSize="13"
                    Margin="10,0,5,0">
        
                    <Run Text="Яскравість на:"/>
                    <Run Text="{Binding BrightnessLevel}"/><Run Text="%"/>
                </TextBlock>

                <Button
                    x:Name="DeleteBrightnessAction"
                    Grid.Column="2"
                    Style="{ThemeResource AccentButtonStyle}"
                    Height="30"
                    Width="50"
                    Margin="0,0,5,0"
                    ToolTipService.ToolTip="{StaticResource DeleteActionTitle}"
                    Click="DeleteBrightnessAction_Click">

                    <Viewbox
                        Margin="1">
                        <SymbolIcon Symbol="Delete"/>
                    </Viewbox>
                </Button>
            </Grid>
        </DataTemplate>

        <DataTemplate x:Key="SoundActionTemplate">
            <Grid Margin="0,10,0,10">

                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <ImageIcon
                    Height="30"
                    Source="../../Assets/sound.png"
                    Grid.Column="0"/>

                <TextBlock
                    Grid.Column="1"
                    VerticalAlignment="Center"
                    FontSize="13"
                    Margin="10,0,5,0">

                    <Run Text="Звук на:"/>
                    <Run Text="{Binding SoundLevel}"/><Run Text="%"/>
                </TextBlock>

                <Button
                    x:Name="DeleteSoundActionButton"
                    Grid.Column="2"
                    Style="{ThemeResource AccentButtonStyle}"
                    Height="30"
                    Width="50"
                    Margin="0,0,5,0"
                    ToolTipService.ToolTip="{StaticResource DeleteActionTitle}"
                    Click="DeleteSoundActionButton_Click">

                    <Viewbox
                        Margin="1">
                        <SymbolIcon Symbol="Delete"/>
                    </Viewbox>
                </Button>
            </Grid>
        </DataTemplate>

        <tools:ActionTemplateSelector 
            x:Key="ActionTemplateSelector" 
            FileActionTemplate="{StaticResource FileActionTemplate}"
            WebActionTemplate="{StaticResource WebActionTemplate}"
            PauseActionTemplate="{StaticResource PauseActionTemplate}"
            BrightnessActionTemplate="{StaticResource BrightnessActionTemplate}"
            SoundActionTemplate="{StaticResource SoundActionTemplate}"/>
    </Page.Resources>
    
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="70"/>
            <RowDefinition/>
            <RowDefinition Height="50"/>
        </Grid.RowDefinitions>

        <!--Top panel-->
        <Border
            Background="{ThemeResource CardBackgroundFillColorSecondaryBrush}">

            <Grid
                x:Name="PanelGrid"
                Margin="10,0,10,0">

                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <TextBox
                    x:Name="AdaptiveTextBox"
                    Padding="10,6,0,0"
                    Text="{x:Bind ViewModel.AppState.SelectedModifyingCustomCommand.Command, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                    Grid.Column="0"
                    MinWidth="170"
                    MaxWidth="600"
                    Height="35"
                    HorizontalAlignment="Left"/>

                <DropDownButton
                    x:Name="AddDropDownButton"
                    Grid.Column="1"
                    Margin="10,0,0,0"
                    Content="Додати дію"
                    Style="{StaticResource AccentDropDownButtonStyle}">

                    <DropDownButton.Flyout>
                        <MenuFlyout Placement="Bottom">
                            <MenuFlyoutItem Text="Відкрити файл" 
                                            Command="{x:Bind ViewModel.AddNewFileActionCommand}">
                                <MenuFlyoutItem.Icon>
                                    <SymbolIcon Symbol="OpenFile"/>
                                </MenuFlyoutItem.Icon>
                            </MenuFlyoutItem>

                            <MenuFlyoutItem Text="Відкрити веб-сторінку"
                                            Command="{x:Bind ViewModel.AddNewWebActionCommand}">
                                <MenuFlyoutItem.Icon>
                                    <SymbolIcon Symbol="Link"/>
                                </MenuFlyoutItem.Icon>
                            </MenuFlyoutItem>

                            <MenuFlyoutItem Text="Зробити паузу"
                                            Command="{x:Bind ViewModel.AddNewPauseActionCommand}">
                                <MenuFlyoutItem.Icon>
                                    <SymbolIcon Symbol="Clock"/>
                                </MenuFlyoutItem.Icon>
                            </MenuFlyoutItem>

                            <MenuFlyoutItem Text="Змінити яскравість"
                                            Command="{x:Bind ViewModel.AddNewBrightnessActionCommand}">
                                <MenuFlyoutItem.Icon>
                                    <FontIcon FontFamily="Segoe MDL2 Assets" Glyph="&#xE706;"/>
                                </MenuFlyoutItem.Icon>
                            </MenuFlyoutItem>

                            <MenuFlyoutItem Text="Змінити рівень звуку"
                                            Command="{x:Bind ViewModel.AddNewSoundActionCommand}">
                                <MenuFlyoutItem.Icon>
                                    <FontIcon FontFamily="Segoe MDL2 Assets" Glyph="&#xE994;"/>
                                </MenuFlyoutItem.Icon>
                            </MenuFlyoutItem>
                        </MenuFlyout>
                    </DropDownButton.Flyout>
                </DropDownButton>
            </Grid>
        </Border>

        <ListView
            CanReorderItems="True"
            AllowDrop="True"
            CanDragItems="True"
            Grid.Row="1"
            ItemTemplateSelector="{StaticResource ActionTemplateSelector}"
            ItemsSource="{x:Bind ViewModel.AppState.SelectedModifyingCustomCommand.Actions, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
        </ListView>

        <Border
            Grid.Row="2"
            Background="{ThemeResource CardBackgroundFillColorSecondaryBrush}">

            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="auto"/>
                </Grid.ColumnDefinitions>

                <StackPanel
                    Grid.Column="1"
                    Spacing="10"
                    Margin="0,0,10,0"
                    Orientation="Horizontal">

                    <Button
                        Command="{x:Bind ViewModel.CancelModifyingCommand}"
                        Padding="10,7,10,7">
                        <StackPanel
                            Spacing="7"
                            Orientation="Horizontal">
                            <Viewbox
                                Width="15">
                                <SymbolIcon Symbol="Cancel"/>
                            </Viewbox>

                            <TextBlock
                                Margin="0,-2,0,0"
                                Text="Скасувати"/>
                        </StackPanel>
                    </Button>

                    <Button
                        Style="{ThemeResource AccentButtonStyle}"
                        Padding="10,7,10,7"
                        Command="{x:Bind ViewModel.SaveChanges}">
                        <StackPanel
                            Spacing="7"
                            Orientation="Horizontal">
                            <Viewbox
                                Width="15">
                                <SymbolIcon Symbol="Save"/>
                            </Viewbox>

                            <TextBlock
                                Margin="0,-2,0,0"
                                Text="Зберегти"/>
                        </StackPanel>
                    </Button>
                </StackPanel>
            </Grid>
        </Border>
    </Grid>
</Page>
